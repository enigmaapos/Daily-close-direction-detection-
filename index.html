<!doctype html><html lang="en"><head><meta charset="utf-8"/>
<title>15m Bull / Bear Probability ‚Äî Pro Scanner</title>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<style>
body{font-family:Inter,system-ui,Arial;background:#0f1720;color:#e6eef8;margin:16px}
h1{font-size:18px;margin-bottom:6px}
h2{font-size:15px;margin:12px 0 6px}
.muted{color:#9fb3cc;font-size:13px}
button,input,label{padding:6px 10px;border-radius:6px;border:1px solid #334155;background:#0b1220;color:#e6eef8}
button.primary{background:#22c55e;border:0;color:#042e16;font-weight:700;cursor:pointer}
.row{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:10px}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:12px}
.card{background:#0b1220;border:1px solid #172033;border-radius:10px;padding:12px}
.bull{color:#22c55e}.bear{color:#fb7185}.neutral{color:#facc15}.prob{font-weight:700}
.bar{height:6px;background:#0b1220;border-radius:6px;overflow:hidden;margin-bottom:10px}
.bar>div{height:100%;width:0%;background:#22c55e;transition:width .2s}
</style></head><body>

<h1>üìä 15m Bull / Bear Probability ‚Äî Pro Scanner</h1>
<div class="muted" id="status">Idle</div>

<div class="bar"><div id="pb"></div></div>

<!-- CONTROLS -->
<div class="row">
<button class="primary" onclick="runScan()">Run Scan</button>
<button onclick="toggleAuto()">Auto</button>
<span class="muted" id="timestamp"></span>
</div>

<!-- SEARCH -->
<div class="row">
<input id="symbolSearch" placeholder="Search symbol (BTCUSDT)" />
<button onclick="runSearch()">Analyze</button>
</div>

<!-- FILTERS -->
<div class="row">
<label><input type="checkbox" id="fSB" checked> Strong Bull</label>
<label><input type="checkbox" id="fWB" checked> Weak Bull ‚â•20%</label>
<label><input type="checkbox" id="fSR" checked> Strong Bear</label>
<label><input type="checkbox" id="fWR" checked> Weak Bear ‚â•20%</label>
</div>

<h2>üîç Search Result</h2>
<div class="grid" id="searchGrid"></div>

<h2>üü¢ Top 30 GREEN</h2>
<div class="grid" id="greenGrid"></div>

<h2>üî¥ Top 30 RED</h2>
<div class="grid" id="redGrid"></div>

<script>
/* ===== DOM ===== */
const gG=greenGrid,rG=redGrid,sG=searchGrid,
st=status,ts=timestamp,pb=document.getElementById("pb");

/* ===== CONFIG ===== */
const API="https://fapi.binance.com",DELAY=300,AUTO=3e5;
const BL=new Set(["ALPACAUSDT","BNXUSDT","ALPHAUSDT","OCEANUSDT","DGBUSDT","AGIXUSDT",
"LINAUSDT","LOKAUSDT","KEYUSDT","MDTUSDT","LOOMUSDT","RENUSDT","OMNIUSDT","SLERFUSDT",
"STMXUSDT","UXLINKUSDT","BSWUSDT","NEIROETHUSDT","VIDTUSDT","TROYUSDT","BAKEUSDT",
"MEMEFIUSDT","NULSUSDT","HIFIUSDT","LEVERUSDT","XEMUSDT","STRAXUSDT","COMBOUSDT",
"AI16ZUSDT","MILKUSDT","TOKENUSDT","SXPUSDT","MYROUSDT","1000XUSDT","DARUSDT"]);

let cards=new Map(),auto=null,done=0;

/* ===== HELPERS ===== */
const f=()=>({SB:fSB.checked,WB:fWB.checked,SR:fSR.checked,WR:fWR.checked});
const sl=m=>new Promise(r=>setTimeout(r,m));
const fj=async u=>(await fetch(u)).json();
const now=()=>new Date().toLocaleTimeString();
const ema=(v,p)=>{let k=2/(p+1),e=v[0];for(let i=1;i<v.length;i++)e=v[i]*k+e*(1-k);return e};
const rsi=(c,p=14)=>{let g=0,l=0;for(let i=1;i<=p;i++){let d=c[i]-c[i-1];d>0?g+=d:l-=d}
let rs=g/(l||1),r=100-(100/(1+rs));
for(let i=p+1;i<c.length;i++){let d=c[i]-c[i-1];
d>0?(g=(g*(p-1)+d)/p,l=(l*(p-1))/p):(g=(g*(p-1))/p,l=(l*(p-1)-d)/p);
rs=g/(l||1);r=100-(100/(1+rs))}return r};

/* ===== ANALYSIS ===== */
async function analyze(sym,bear,dd){
const k=await fj(`${API}/fapi/v1/klines?symbol=${sym}&interval=15m&limit=120`);await sl(DELAY);
const c=k.map(x=>+x[4]),v=k.map(x=>+x[5]),l=k.at(-1);
let s=0,av=v.slice(-40).reduce((a,b)=>a+b,0)/40,e=ema(c.slice(-60),50),ri=rsi(c);
if(!bear){l[4]>e&&s++;l[4]>k.at(-2)[4]&&s++;ri>50&&s++;l[5]>av&&s++}
else{l[4]<e&&s++;l[4]<k.at(-2)[4]&&s++;ri<50&&s++;l[5]>av&&s++}
if(!bear){dd>=-1&&s++;dd<=-7&&(s-=2);dd<=-4&&(s--)}
else{dd<=-1&&s++;dd>-1&&(s--)}
s=Math.max(0,Math.min(5,s));
return{sym,prob:s*20,dd,
bias:s>=4?(bear?"Strong Bear":"Strong Bull"):
s===3?(bear?"Weak Bear":"Weak Bull"):
s===2?"Neutral":(bear?"Weak Bull":"Weak Bear")}
}

/* ===== FILTER ===== */
function pass(d){
const x=f();
if(d.bias==="Strong Bull"&&x.SB)return true;
if(d.bias==="Weak Bull"&&d.prob>=20&&x.WB)return true;
if(d.bias==="Strong Bear"&&x.SR)return true;
if(d.bias==="Weak Bear"&&d.prob>=20&&x.WR)return true;
return false;
}

/* ===== RENDER ===== */
function render(d,el){
if(!pass(d))return;
const c=document.createElement("div");
const pc=d.bias.includes("Bull")?"bull":d.bias.includes("Bear")?"bear":"neutral";
const dc=d.dd>=-1?"bull":d.dd<=-4?"bear":"neutral";
c.className="card";
c.innerHTML=`<b>${d.sym}</b>
<div class="prob ${pc}">${d.bias} ‚Äî ${d.prob}%</div>
<div class="muted ${dc}">24h Drawdown: ${d.dd.toFixed(2)}%</div>
<div class="muted">Updated: ${now()}</div>`;
el.appendChild(c);
}

/* ===== SEARCH ===== */
async function runSearch(){
const sym=symbolSearch.value.trim().toUpperCase();
if(!sym.endsWith("USDT")||BL.has(sym))return;
sG.innerHTML="";
const t=await fj(`${API}/fapi/v1/ticker/24hr?symbol=${sym}`);
render(await analyze(sym,t.priceChangePercent<0,(t.lastPrice-t.highPrice)/t.highPrice*100),sG);
}

/* ===== SCAN ===== */
async function runScan(){
gG.innerHTML="";rG.innerHTML="";done=0;pb.style.width="0%";st.innerText="Scanning...";
const t=await fj(`${API}/fapi/v1/ticker/24hr`);
const u=t.filter(x=>x.symbol.endsWith("USDT")&&!BL.has(x.symbol));
const total=60;

for(const x of u.sort((a,b)=>b.priceChangePercent-a.priceChangePercent).slice(0,30)){
render(await analyze(x.symbol,false,(x.lastPrice-x.highPrice)/x.highPrice*100),gG);
pb.style.width=`${(++done/total)*100}%`;
}
for(const x of u.sort((a,b)=>a.priceChangePercent-b.priceChangePercent).slice(0,30)){
render(await analyze(x.symbol,true,(x.lastPrice-x.highPrice)/x.highPrice*100),rG);
pb.style.width=`${(++done/total)*100}%`;
}
ts.innerText=new Date().toLocaleString();st.innerText="Completed";
}

function toggleAuto(){
if(auto){clearInterval(auto);auto=null;st.innerText="Auto stopped"}
else{runScan();auto=setInterval(runScan,AUTO);st.innerText="Auto running"}
}
</script></body></html>
